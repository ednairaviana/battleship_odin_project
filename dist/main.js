(()=>{"use strict";class e{constructor(e){this.length=e,this.isSunk=!1}hit(){this.length-=1,0===this.length&&(this.isSunk=!0)}}class t{constructor(){this.square=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],this.ships=[]}isAllSunk(){return!!this.ships.every((e=>!0===e.isSunk))}isEmptyCoordinate(e){const t=e[0],s=e[1];return 0===this.square[t][s]}isPossiblePlaceShip(e,t,s){const i=e[0],r=e[1];if("vertical"===t)for(let e=0;e<s;e++){if(i+s>10)return!1;if(0!==this.square[i+e][r])return!1}else if("horizontal"===t)for(let e=0;e<s;e++){if(r+s>10)return!1;if(0!==this.square[i][r+e])return!1}return!0}placeShip(t,s,i){const r=new e(i),o=t[0],a=t[1];if("vertical"===s)for(let e=0;e<i;e++)this.square[o+e][a]=r;else if("horizontal"===s)for(let e=0;e<i;e++)this.square[o][a+e]=r;this.ships.push(r)}receiveAttack(e){const t=e[0],s=e[1];return"object"==typeof this.square[t][s]?(this.square[t][s].hit(),this.square[t][s]=2,!0):(this.square[t][s]=1,!1)}}class s{constructor(){this.name="BOT",this.board=new t,this.enemy=null,this.turn=null,this.queue=[],this.allProbabilities=this.setAllProbabilities()}setAllProbabilities(){const e=[];for(let t=0;t<10;t++)for(let s=0;s<10;s++)e.push([t,s]);return e}attack(){this.allProbabilities=this.allProbabilities.filter((function(e){return void 0!==e}));let e=null;if(this.queue.length>0)e=this.queue.shift();else{const t=Math.floor(Math.random()*this.allProbabilities.length);e=this.allProbabilities[t],delete this.allProbabilities[t]}const t=e[0],s=e[1];return"object"==typeof this.enemy.board.square[t][s]&&this.filterQueue(t,s),this.enemy.board.receiveAttack([t,s]),[t,s]}filterQueue(e,t){[[e-1,t],[e+1,t],[e,t-1],[e,t+1]].forEach((e=>{this.allProbabilities.forEach(((t,s)=>{e[0]===t[0]&&e[1]===t[1]&&(this.queue.push([t[0],t[1]]),delete this.allProbabilities[s])}))}))}placeAllShips(){const e=[2,2,3,3,4,4,5];let t=0;for(;t<e.length;){const s=Math.floor(10*Math.random()),i=Math.floor(10*Math.random());let r=Math.floor(2*Math.random());r=0===r?"horizontal":"vertical",this.board.isPossiblePlaceShip([s,i],r,e[t])&&(this.board.placeShip([s,i],r,e[t]),t++)}}checkGameOver(){return!!this.board.isAllSunk()}}const i={plOne:null,plTwo:null,isCurrentTurn:!0,board:{first:document.querySelector("#first"),second:document.querySelector("#second")},positionBtn:{vertical:document.querySelector(".vert-btn"),horizontal:document.querySelector(".hori-btn")}};function r(e,t,s,r,c){const h=document.createElement("div");h.classList.add("square"),r&&(h.style.backgroundColor=c,h.style.boxShadow="inset 0 0 3px white"),e.insertAdjacentElement("beforeend",h),h.addEventListener("click",(async()=>{(function(e,t){const s=document.createElement("div");s.classList.add("flex-center-column","display-msg"),s.innerHTML="<p>Perdeu ot√°rio!!!</p>";const r=document.createElement("div");r.classList.add("btn-restart"),r.innerText="new game",s.insertAdjacentElement("beforeend",r),r.addEventListener("click",(()=>{a(i.board.first),a(i.board.second),l()})),e.appendChild(s)})(i.board.second),i.board.second.style.pointerEvents="none",i.plTwo.board.receiveAttack([t,s])?await n(h,c):await n(h,"#000"),o()}))}const o=async()=>{const e=i.plTwo.attack(),t=parseInt(`${e[0]}${e[1]}`);1===i.plOne.board.square[e[0]][e[1]]?await n(i.board.first.childNodes[t],"#000"):await n(i.board.first.childNodes[t],"gray"),i.board.second.style.pointerEvents="auto"};function a(e){for(;e.firstChild;)e.removeChild(e.firstChild)}const n=async(e,t)=>{const s=e=>new Promise((t=>setTimeout(t,e))),i=t,r="#151515";function o(t){e.style.backgroundColor=t}e.style.pointerEvents="none",o("gray"),await s(200),o(r),await s(200),o("gray"),await s(200),o(r),await s(100),o("gray"),await s(100),o(r),await s(100),o("gray"),await s(300),o(i)};function l(){const e=new s,t=new s;e.enemy=t,t.enemy=e,i.plOne=e,i.plTwo=t,e.placeAllShips(),t.placeAllShips(),i.plOne.board.square.forEach(((e,t)=>{e.forEach(((e,s)=>{r(i.board.first,t,s,"object"==typeof e,"var(--fst-main-color)")}))})),i.plTwo.board.square.forEach(((e,t)=>{e.forEach(((e,s)=>{r(i.board.second,t,s,!1,"var(--scd-main-color)")}))})),i.board.first.pointerEvents="none",console.log(e.board.square),console.log(t.board.square)}l()})();